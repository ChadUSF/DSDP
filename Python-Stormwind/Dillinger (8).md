# Revolutionizing Rehabilitation: Migrating from RDBMS to Cassandra for Enhanced Data Management
##### Conducted By:
University of South Florida
GBAIS
Big Data for Business Applications 
ISM 6562

- [Katherine Brock](https://www.linkedin.com/in/katherinebrock1)
- [Seth Carr](https://www.linkedin.com/in/seth-carr-813933185)
- [Jeffrey Giambrone](https://www.linkedin.com/in/jeff-giambrone)
- [Rohini Kasat](https://www.linkedin.com/in/rhnkst)
- [Chad Lutz](https://www.linkedin.com/in/chad-f-lutz)

### Introduction

In the digital era, the ability to manage and analyze data efficiently is a necessity for organizations across various domains. For prison rehabilitation centers that cater to a diverse population, maintaining an extensive record system encompassing client profiles, criminal records, counseling sessions, job applications, and educational achievements across numerous locations becomes paramount. As the centers expand operations and services, the limitations of traditional Relational Database Management Systems (RDBMS) in handling big data applications become increasingly apparent. This report outlines the process of transitioning from an RDBMS to Apache Cassandra, a move driven by the need to utilize big data through a system designed for scalability, performance, and high availability.

#### Scope

Through this process, we will dissect and reconstruct an RDBMS schema, ensuring it is optimally reimagined for a NoSQL environment. Key elements of our exploration include:

- **Data Access Pattern Analysis:** Prioritizing the identification and understanding of prevalent data access patterns within prison rehabilitation centers. This analysis will direct our schema design in Cassandra, ensuring that our database architecture supports the most common and critical queries.

- **Efficient Data Model Design:** Leveraging the "Query First" approach, we will design data models that are not only efficient, but also scalable and adaptable to the dynamic needs of the prison rehabilitation centers. This involves denormalizing data where necessary, strategically selecting partition keys, and effectively utilizing clustering columns to optimize query performance.

- **Schema Translation Mechanics:** Focusing on the nuanced process of translating complex relational schemas—comprising tables, relationships, and constraints—into Cassandra's flat, denormalized structure. This will include practical exercises in rethinking data relationships in the context of NoSQL's limitations and capabilities.

- **Performance and Scalability Optimization:** Exploring strategies to enhance performance and ensure scalability within Cassandra, including the use of secondary indexes where appropriate and the careful consideration of data distribution and replication across the cluster.

- **Real-world Application and Implications:** Drawing connections between the theoretical aspects of our schema migration and the practical implications for the prison rehabilition centers. This includes evaluating the impact on functionality, user experience, and overall system performance.

#### Objectives

- **Enhance Scalability:** To establish a data management system that can seamlessly scale horizontally to accommodate the growing volume of data generated by expanding client bases and service offerings.

- **Ensure High Availability:** To implement a fault-tolerant system that guarantees continuous access to critical data across multiple geographical locations, ensuring that the center's operations remain uninterrupted.

- **Optimize for Write-intensive Workloads:** To efficiently manage high volumes of transactions, including new entries, updates, and real-time data processing.

- **Adapt to Flexible Data Models:** To create a system capable of evolving with centers' needs, allowing for the rapid incorporation of new data types and access patterns.

- **Reduce Operational Costs at Scale:** To leverage Cassandra's open-source nature to build a cost-effective solution that remains economically viable as data volume and access demands increase.

#### Significance

Migrating to Cassandra represents a strategic initiative to future-proof prison rehabilitation centers' data management capabilities. This transition is significant not only for its immediate benefits—scalability, performance, and reliability, but also for its alignment with the long-term vision of utilizing data to enhance service delivery, operational efficiency, and client outcomes. By adopting a "Query First" design approach, the project emphasizes the importance of tailoring the data schema to the specific needs and access patterns of the centers, ensuring that the migration fully capitalizes on Cassandra's strengths. This initiative sets a foundation for leveraging big data analytics, offering insights that can drive informed decision-making and foster innovation in rehabilitation services.


#### Analyzing the RDBMS Schema
This section provides a detailed overview of the RDBMS schema used by the rehabilitation centers and prison systems, including table structures, relationships, and key assumptions.

**Entity-Relationship Diagram (ERD)**
Below are the links to the ERD images representing the current RDBMS schema of the prison rehabilitation centers and prison systems. 

**Conceptual Model**
[Conceptual Model ERD (PNG)](https://drive.google.com/file/d/1ZX6JLJ4ij25mqUuvqBQCDg0gMXxDYjpf/view?usp=sharing)

**Relational Model**
[Relational Model ERD (PNG)](https://drive.google.com/file/d/1oqsFKzKiLV1qUPJGdEBEHlzGGcWTrxFY/view?usp=sharing)

**Tables Overview**
The schema consists of the following tables:
- Client
- IncarcerationFacility
- CounselingServices
- CounselingRegistration
- JobApplication
- JobOpening
- Courses
- CourseRegistration

**Client Table**

| Column      | Type         | Description                             |
|-------------|--------------|-----------------------------------------|
| ClientID    | Primary Key  | Unique identifier for each client.      |
| Name        | Text         | Full name of the client.               |
| Gender      | Text         | Gender of the client.                   |
| Age         | Integer      | Age of the client.                      |
| DateEntered | Date         | Date the client entered the program.    |
| MentorID    | Foreign Key  | Reference to the mentor of the client.  |

*Description: Stores personal information about the rehabilitation center's clients.*

**IncarcerationFacility Table**

| Column        | Type         | Description                                        |
|---------------|--------------|----------------------------------------------------|
| IncFacID      | Primary Key  | Unique identifier for each incarceration facility. |
| ClientID      | Foreign Key  | Reference to the client.                           |
| FacilityName  | Text         | Name of the incarceration facility.               |
| Location      | Text         | Location of the facility.                          |
| ReleaseDate   | Date         | Scheduled release date of the client.              |

*Description: Records details about the incarceration facilities where clients are held.*

**CounselingServices Table**

| Column              | Type         | Description                                     |
|---------------------|--------------|-------------------------------------------------|
| CounselingServicesID| Primary Key  | Unique identifier for each counseling service.  |
| AreaOfFocus         | Text         | Main focus area of the counseling service.      |

*Description: Details the various types of counseling services offered.*

**CounselingRegistration Table**

| Column             | Type         | Description                                            |
|--------------------|--------------|--------------------------------------------------------|
| CounselingRegID    | Primary Key  | Unique identifier for each counseling service registry.|
| CounselingServicesID| Foreign Key | Reference to the counseling services.                  |
| ClientID           | Foreign Key  | Reference to the client.                               |
| Hours              | Integer      | Number of hours spent in counseling by the client.     |

*Description: Tracks registrations and hours spent by clients in counseling services.*

**JobApplication Table**

| Column             | Type         | Description                                       |
|--------------------|--------------|---------------------------------------------------|
| JobApplicationID   | Primary Key  | Unique identifier for each job application.       |
| JobOpeningID       | Foreign Key  | Reference to the job opening.                     |
| ClientID           | Foreign Key  | Reference to the client.                          |
| ApplicationDate    | Date         | Date when the application was submitted.          |
| ApplicationOutcome | Text         | Outcome of the application (e.g., accepted, rejected).|

*Description: Tracks job applications submitted by clients and their outcomes.*

**JobOpening Table**

| Column       | Type         | Description                               |
|--------------|--------------|-------------------------------------------|
| JobOpeningID | Primary Key  | Unique identifier for each job opening.   |
| JobTitle     | Text         | Title of the job position.                |
| CompanyName  | Text         | Name of the company offering the job.     |
| HourlyWage   | Decimal      | Hourly wage for the job position.         |

*Description: Information about job openings available for clients.*

**Courses Table**

| Column    | Type         | Description                              |
|-----------|--------------|------------------------------------------|
| CourseID  | Primary Key  | Unique identifier for each course.       |
| Title     | Text         | Title of the course.                     |
| Duration  | Integer      | Duration of the course in hours.         |

*Description: Lists educational courses available to clients.*

**CourseRegistration Table**

| Column          | Type         | Description                                         |
|-----------------|--------------|-----------------------------------------------------|
| CrsRegID        | Primary Key  | Unique identifier for each course registration.     |
| CourseID        | Foreign Key  | Reference to the course.                            |
| ClientID        | Foreign Key  | Reference to the client.                            |
| CompletionDate  | Date         | Date when the course was completed.                 |
| Grade           | Text         | Grade achieved by the client in the course.         |
| BehaviorScore   | Integer      | Behavioral score of the client in the course.       |

*Description: Records the courses that clients have registered for, completed, and their performance.*

**Relationships**

- **Client - IncarcerationFacility:** One-to-Many. A client may have records in multiple incarceration facilities.
- **Client - CounselingRegistration:** One-to-Many. A client can register for multiple counseling services.
- **CounselingServices - CounselingRegistration:** One-to-Many. A counseling service can be registered for by multiple clients.
- **Client - JobApplication:** One-to-Many. A client can submit applications for multiple job openings.
- **JobOpening - JobApplication:** One-to-Many. A job opening can have applications from multiple clients.
- **Client - CourseRegistration:** One-to-Many. A client can register for multiple courses.
- **Courses - CourseRegistration:** One-to-Many. A course can have registrations from multiple clients.

**Assumptions**
1. **Data Completeness:** Assumes every client has at least one entry in the `Client` table and can be linked to entries in other tables such as `IncarcerationFacility`, `CounselingRegistration`, `JobApplication`, and `CourseRegistration`.

2. **Data Integrity:** Maintains referential integrity through foreign keys, ensuring that all relationships between tables are consistent, and that there are no orphaned records.

3. **Usage Patterns:** Optimized for queries related to client profiles, incarceration details, counseling services, job applications, and course registrations, which are the most common operations in the system.

4. **Privacy Compliance:** Ensures access to sensitive data complies with privacy laws and regulations, including but not limited to data about clients' criminal history, personal information, and rehabilitation progress.

5. **Scalability and Performance:** Designed with scalability in mind to handle increasing amounts of data over time, with the ability to add new services, courses, and job opportunities without significant restructuring.

6. **Transactional Consistency:** Ensures that all transactions are processed in a reliable manner, particularly with regard to client registrations for counseling, courses, and job applications, as well as updates to incarceration facilities.

7. **Data Recovery and Durability:** Assumes that mechanisms are in place for data backup and recovery to prevent loss of important client and operational data.

8. **Operational Continuity:** Designed to support the ongoing operations of the rehabilitation center, allowing for continuous access and update of data as clients progress through rehabilitation programs and services.

### Query Analysis

Key queries analyzed for application functionality include:
1. Find all clients in a particular facility.
2. Find details about a client such as Name, Age, Date entered.
3. Find counseling programs registered by a client.
4. Find clients registered in a counseling service.
5. Find jobs applied by a client.
6. Find all jobs posted by a company.
7. Find courses enrolled by a client.
8. Find details about a course.
9. Find type of crime that a client committed.

**Query Workflow Diagram**
The Query Workflow Diagram outlines the interactions users can have with the system and the sequence of operations or queries that can be performed.
[Query Workflow Diagram](https://drive.google.com/file/d/1ibXYWJcIF6WgEmMC95WOC0VV3qZ972cL/view?usp=sharing)

**Logical Data Model**
A Logical Data Model (LDM) outlines the structure of a database system by mapping out the interrelations of entities and attributes, typically without regard to physical design considerations.
[Logical Data Model](https://drive.google.com/file/d/1Iamevk_ztYW0zeHgCeLZPXs017xcLf3-/view?usp=sharing)

### Designing Cassandra Schema

Given the "Query First" approach, we redesigned the schema to optimize for the listed queries, emphasizing the denormalization and duplication typical of Cassandra models for direct query support.

##### Q1: Find all clients in a particular facility

- **Original RDBMS Approach:**
Join between `Clients` and `Facilities` tables based on `FacilityID`.

- **Cassandra Schema Transformation:**
```sql
CREATE TABLE clients_by_facility (
    facility_id uuid,
    client_id uuid,
    client_name text,
    PRIMARY KEY (facility_id, client_id)
);
```
*Optimization: Direct access to clients based on facility_id without the need for a join.*

##### Q2: Find Details about a client such as Name, Age, and Date Entered
- **Original RDBMS Approach:**
Direct query on the `Clients` table using `ClientID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Crime.Client
AS SELECT *
FROM Crime.Client
WHERE ClientID IS NOT NULL and IncFacID IS NOT NULL
PRIMARY KEY (ClientID, IncFacID);
```
*Optimization: Single-table access with all relevant client details.*

##### Q3: Find counseling programs registered by a client
- **Original RDBMS Approach:**
Join `Clients` to `CounselingRegistrations` on `ClientID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Counseling.programs_byclients
AS SELECT *
FROM Counseling.CounselingProgram_by_Client
WHERE ClientID IS NOT NULL and CounselingServicesID IS NOT NULL
PRIMARY KEY (ClientID, CounselingServicesID);
```
*Optimization: Enables retrieval of counseling sessions for a client in reverse chronological order.*

##### Q4: Find clients registered in a counseling service
- **Original RDBMS Approach:**
Reverse join of Q3, from `CounselingRegistrations` to `Clients`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Counseling.CounselingService_by_Client
AS SELECT *
FROM Counseling.client_by_counselingprogram
WHERE ClientID IS NOT NULL and CounselingServicesID IS NOT NULL
PRIMARY KEY (ClientID, CounselingServicesID);
```
*Optimization: Allows for listing all clients in a specific program, sorted by date.* 

##### Q5: Find jobs applied by a client.
- **Original RDBMS Approach:**
Join `Clients` to `JobApplications` on `ClientID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Jobs.Applied_by_Client
AS SELECT *
FROM Jobs.Jobs_by_Client
WHERE ClientID IS NOT NULL and JobTitle IS NOT NULL
PRIMARY KEY (ClientID, JobTitle);
```
*Optimization: Directly fetch job applications per client, sorted by application date.*

##### Q6: Find all jobs posted by a company.
- **Original RDBMS Approach:**
Query `Jobs` table filtered by `CompanyName`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Jobs.Posted_by_Company
AS SELECT *
FROM Jobs.Jobs_by_Company
WHERE CompanyName IS NOT NULL and JobTitle IS NOT NULL
PRIMARY KEY (CompanyName, JobTitle);
```
*Optimization: Facilitates listing of jobs by a company, sorted by posting date.*

##### Q7: Find courses enrolled by a client.
- **Original RDBMS Approach:**
Join `Client`s to `CourseRegistrations` on `ClientID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Courses.Enrolled_by_Client
AS SELECT *
FROM Courses.Enrolled_by_Client
WHERE ClientID IS NOT NULL and CourseID IS NOT NULL
PRIMARY KEY (ClientID, CourseID);
```
*Optimization: Easily access courses a client is enrolled in, ordered by enrollment date.*

##### Q8: Find details about a course.
- **Original RDBMS Approach:**
Direct query on the `Courses` table using `CourseID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Courses.Details_of_Course
AS SELECT *
FROM Courses.Details_of_Course
WHERE CourseID IS NOT NULL
PRIMARY KEY (CourseID);

CREATE KEYSPACE Jobs
WITH replication = {'class': 'SimpleStrategy', 'replication_factor' : 3};

CREATE TYPE Jobs.Applied_by_Client(
JobTitle text,
CompanyName text,
ClientID uuid,
ApplicationDate date,
PRIMARY KEY (ClientID, JobTitle)
) WITH comment = 'Q5. Find jobs applied for by a client';

CREATE TYPE Jobs.Posted_by_Company (
CompanyName text,
JobTitle text,
HourlyWage double,
PRIMARY KEY (CompanyName, JobTitle)
) WITH comment = 'Q6. Find jobs posted by a company';
```
*Optimization: Maintains straightforward access to course details, similar to RDBMS but optimized for NoSQL.*

##### Q9: Find type of crime that a client committed
- **Original RDBMS Approach:**
Join `Clients` to `Crimes` on `ClientID`.

- **Cassandra Schema Transformation:**
```sql
cqlsh> CREATE MATERIALIZED VIEW Crime.crimes_by_client
AS SELECT *
FROM Crime.Crimes_by_Client
WHERE ClientID IS NOT NULL and CrimeID IS NOT NULL
PRIMARY KEY (ClientID, CrimeID);
```
*Optimization: Allows chronological retrieval of crimes committed by a client.*

### Discussion 
Reflecting on the transition from a traditional RDBMS to Apache Cassandra for our application posed several challenges and required careful consideration of trade-offs. Having an established RDBMS foundation, however, provided a clear schema and a well-defined set of relationships and queries, which served as a valuable blueprint for the transition. It allowed us to identify the most critical aspects of our data management needs, which in turn informed our approach to modeling data in Cassandra. This journey not only tested our technical acumen, but also provided unexpected insights into the management of big data within the context of prison rehabilitation centers.

One of the key challenges was rethinking our data modeling approach to fit the denormalized, distributed nature of Cassandra, which contrasts with the normalized, relational structure of traditional SQL databases. This shift necessitated a "Query First" mindset, where we designed our tables around the queries we intended to run, rather than structuring data around normalized forms and relationships.

The trade-offs were apparent in aspects such as transactional integrity and join operations. While RDBMSs excel in ACID transactions, Cassandra trades off some transactional capabilities for increased scalability and fault tolerance. Furthermore, Cassandra's lack of join operations meant we had to duplicate data across tables to efficiently access it in the ways required by our application. While this introduced some data redundancy, it was a necessary trade-off for the high read and write throughput provided by Cassandra, which was critical for our application's performance requirements.

**Unexpected Benefits:**
- **Enhanced Data Management:** One of the more surprising outcomes was the ease with which we could handle large volumes of data across distributed systems. Cassandra’s ability to efficiently manage big data led to significant improvements in our application's performance and scalability.

- **System Resilience:** Transitioning to Cassandra improved our system's resilience and fault tolerance. Data replication across multiple nodes ensured that our application remained operational, even in the face of hardware failures.

**Insights Gained:**
- **Team Collaboration and Knowledge Sharing:** The process emphasized the importance of team collaboration and knowledge sharing. Regular discussions and brainstorming sessions were pivotal in overcoming the technical challenges we faced, fostering a culture of continuous learning and improvement.

- **Embracing Change and Flexibility:** The migration process taught us the value of being adaptable. Flexibility in our approaches, whether in data modeling or query optimization, was key to fully leveraging Cassandra's capabilities.

**Overcoming Challenges:**
- **Focused Training and Research:** Dedicated training sessions and extensive research into Cassandra's best practices helped bridge the knowledge gap, enabling our team to better understand and apply Cassandra-specific data management techniques.

- **Iterative Testing and Optimization:** Adopting an iterative approach to testing and optimization allowed us to gradually refine our data models and queries. This hands-on experience was invaluable in understanding the nuances of working with a NoSQL database like Cassandra.

In reflecting on this transition, it becomes clear that while the move to Cassandra introduced challenges, it also brought to light the flexibility and capabilities of NoSQL databases in handling the specific needs of prison rehabilitation center analytics. The insights and knowledge gained from this experience have not only propelled our project forward but have also prepared our team for future technological advancements and challenges.

## Conclusion
The process to translate the RDBMS schema of the prison rehabilitation centers to a Cassandra NoSQL schema has been an enlightening experience that underscored the complexities and nuances of database design in the context of modern data-driven applications. Our team's understanding of the fundamental differences between relational and NoSQL databases has deepened, particularly regarding data structure, scalability, and query optimization.

Key learning outcomes from this exercise include:

- **Data Modeling**: Recognizing the importance of denormalization in NoSQL and its role in optimizing for read performance and horizontal scalability.

- **Query Optimization**: The 'Query First' approach that drove our design process highlighted the need to understand and anticipate the data retrieval patterns to effectively serve operational needs.

- **Scalability and Performance**: Cassandra's distributed architecture promises to accommodate the growing data needs, providing a pathway to scale seamlessly as the demand for data storage and quick access increases.

The potential real-world implications of our schema design decisions are significant:

- **Enhanced Client Services**: With a more scalable and performant database, the prison rehabilitation centers can handle larger datasets, leading to better insights into rehabilitation programs and client management.

- **Operational Resilience**: The fault-tolerant nature of Cassandra ensures high availability, which is crucial for maintaining uninterrupted access to client data.

- **Data Integrity and Security**: While Cassandra does not enforce relationships as strictly as RDBMS systems, careful design and application-side logic have been implemented to maintain data integrity.

- **Efficiency in Resource Utilization**: Optimized data models lead to more efficient use of computational resources, potentially reducing costs and environmental impact.

Looking ahead, Cassandra opens doors to myriad possibilities:

- **Advanced Analytics and Insights:** As the data landscape evolves, so too do the analytics capabilities. Harnessing Cassandra's capabilities in conjunction with advanced analytics tools holds the promise of deeper insights, predictive analytics, and data-driven decision-making, ultimately enhancing rehabilitation outcomes.

- **Integration with Emerging Technologies:** Embracing emerging technologies such as machine learning and artificial intelligence can augment the capabilities of Cassandra, enabling predictive modeling, anomaly detection, and personalized interventions tailored to individual client needs.

This project was not just a technical translation, but also a strategic realignment that positions the organization to leverage data for better outcomes, improving the reintegration process for individuals returning to society. The lessons learned from this project will guide future decisions as we continue to evolve our technological capabilities to meet the needs of our clients and stakeholders.

## References
Arshad, M., Brohi, M. N., Soomro, T. R., Ghazal, T. M., Alzoubi, H. M., & Alshurideh, M. (2023). Nosql: Future of bigdata analytics characteristics and comparison with rdbms. In The Effect of Information Technology on Business and Marketing Intelligence Systems (pp. 1927-1951). Cham: Springer International Publishing.

Khan, M. Z., Zaman, F. U., Adnan, M., Imroz, A., Rauf, M. A., & Phul, Z. (2023). Comparative Case Study: An Evaluation of Performance Computation Between SQL And NoSQL Database. Journal of Software Engineering, 1(2), 14-23.

Lakshman, A., & Malik, P. (2010). Cassandra: a decentralized structured storage system. ACM SIGOPS operating systems review, 44(2), 35-40.

Yedilkhan, D., Mukasheva, A., Bissengaliyeva, D., & Suynullayev, Y. (2023, May). Performance Analysis of Scaling NoSQL vs SQL: A Comparative Study of MongoDB, Cassandra, and PostgreSQL. In 2023 IEEE International Conference on Smart Information Systems and Technologies (SIST) (pp. 479-483). IEEE.